pipeline {
    agent {
        label 'windows'   // Assurez-vous que votre agent Jenkins est un nœud Windows
    }

    environment {
        NODE_VERSION = "24.12.0"
    }

    stages {
        stage('Setup Node.js') {
            steps {
                // Téléchargement et installation silencieuse de Node.js
                bat """
                echo Installing Node.js %NODE_VERSION%
                curl -o nodejs.msi https://nodejs.org/dist/v%NODE_VERSION%/node-v%NODE_VERSION%-x64.msi
                msiexec /i nodejs.msi /quiet /qn /norestart
                """
            }
        }

        stage('Check Node.js Version') {
            steps {
                bat 'node -v'
                bat 'npm -v'
            }
        }

        stage('Install Dependencies') {
            steps {
                bat 'npm install'
            }
        }

        stage('Run Tests') {
            steps {
                bat 'npm test'
            }
        }

        stage('Build') {
            steps {
                bat 'npm run build'
            }
        }
    }

    post {
        always {
            echo 'Pipeline terminé.'
        }
        success {
            echo 'Build et tests réussis ✅'
        }
        failure {
            echo 'Échec du pipeline ❌'
        }
    }
}



  
